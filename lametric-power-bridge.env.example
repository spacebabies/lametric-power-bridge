# =============================================================================
# LaMetric Power Bridge - Configuration
#
# Rename this file to 'lametric-power-bridge.env' before running.
# Do NOT commit the actual 'lametric-power-bridge.env' to your repository.
# If you push your secrets to GitHub, I cannot help you.
# =============================================================================

# -----------------------------------------------------------------------------
# LaMetric Device Configuration
# -----------------------------------------------------------------------------

# 1. LAMETRIC PUSH URL (REQUIRED)
# The full widget URL where we send power data to your LaMetric Time device.
#
# This is REQUIRED. You must obtain the complete URL from the LaMetric Time mobile app.
# The URL does NOT appear in the developer portal - only in the app itself.
#
# The URL contains your widget-specific secret and looks like this:
# http://192.168.2.2:8080/api/v2/widget/update/com.lametric.diy.devwidget/f3b7537fe7a3460db469a9722af3e6a8
#                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
#                                                                          This secret is NOT discoverable
#
# SSDP Auto-Discovery (the clever bit):
# The bridge automatically discovers your LaMetric's IP address via SSDP and replaces
# ONLY the host portion of your configured URL. This handles DHCP lease renewals gracefully.
#
# When your LaMetric gets a new IP (as it inevitably will at 3am on a Tuesday), we update:
#   http://192.168.2.10:8080/api/v2/widget/update/com.lametric.diy.devwidget/f3b7537fe7a3460db469a9722af3e6a8
#           ^^^^^^^^^^^^ - Only this bit changes. Everything else stays constant.
#
# If SSDP discovery fails (or you have multiple devices), we use your configured IP as-is.
# You may now sleep soundly knowing DHCP changes won't break your pretty pixel clock.
#
LAMETRIC_URL=http://192.168.1.50:8080/api/v2/widget/update/com.lametric.diy.devwidget/your_secret_here

# 2. LAMETRIC API KEY (REQUIRED)
# The cryptographic handshake required to speak to the display.
# Finding this requires a scavenger hunt based on the arbitrary age of your device.
#
# 2022 and Earlier Models: Found in the Developer Portal at https://developer.lametric.com/user/devices
# 2022+ Models: Buried somewhere in the LaMetric Time mobile app settings.
#
# I apologize for the inconsistency on behalf of a company I do not work for.
LAMETRIC_API_KEY=your_api_key_here

# -----------------------------------------------------------------------------
# Tibber Configuration (REQUIRED if using --source=tibber)
# -----------------------------------------------------------------------------

# 3. TIBBER API TOKEN
# The magic string that grants access to your consumption data.
# You can get this from developer.tibber.com.
# Try not to paste this into a public Discord channel.
TIBBER_TOKEN=5_M4nyR4nd0mCh4r4ct3rs_D0N0TCOPTHIS_ItIsAnEx4mpl3

# -----------------------------------------------------------------------------
# HomeWizard Configuration (REQUIRED if using --source=homewizard-v1 or homewizard-v2)
# -----------------------------------------------------------------------------

# 4. HOMEWIZARD HOST (OPTIONAL)
# The local IP address or hostname of your HomeWizard device.
#
# Leave this EMPTY to enable auto-discovery (mDNS). The bridge will find your
# "HWE-P1" device on the network automatically, even if its IP address changes.
#
# Only set this manually if you have multiple HomeWizard meters or if mDNS
# discovery is blocked on your network (e.g. across VLANs/subnets).
#
# Example: HOMEWIZARD_HOST=192.168.2.87
HOMEWIZARD_HOST=

# 5. HOMEWIZARD TOKEN (REQUIRED if using --source=homewizard-v2)
# Authentication token for HomeWizard v2 WebSocket API.
# This is NOT your Wi-Fi password or anything remotely sensible.
#
# Requirements:
# - Firmware >= 6.0 (check with: curl http://YOUR_IP/api)
# - Local user created manually via API (see README for the delightful ceremony)
#
# If your firmware version is < 6.0, use --source=homewizard-v1 instead.
# If you cannot be bothered with the user creation ritual, also use v1.
# The v1 API works perfectly fine and does not require this rigamarole.
#
# Example: HOMEWIZARD_TOKEN=your_generated_token_here
HOMEWIZARD_TOKEN=

# -----------------------------------------------------------------------------
# P1 Serial Configuration (REQUIRED if using --source=p1-serial)
# -----------------------------------------------------------------------------

# 6. P1_SERIAL_DEVICE
# The serial device path for your P1 cable.
# Most USB-to-serial adapters show up as /dev/ttyUSB0.
# Run 'ls /dev/ttyUSB*' to see what is available.
#
# If the device refuses to cooperate, you may need to add your user to the 'dialout' group:
#   sudo usermod -a -G dialout $USER
# Then log out and back in. It is 2026; we should not still be fighting with serial port permissions.
#
# Default: /dev/ttyUSB0
P1_SERIAL_DEVICE=/dev/ttyUSB0

# 7. P1_SERIAL_BAUDRATE
# The serial communication speed.
# DSMR v4+ (2014 onwards): 115200 baud
# DSMR v2/v3 (ancient meters): 9600 baud
#
# If you are unsure which version you have, try 115200 first.
# If that does not work, you are probably dealing with a museum piece.
#
# Default: 115200
P1_SERIAL_BAUDRATE=115200
